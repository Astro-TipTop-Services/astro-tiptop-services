---
id: useful_scripts
title: Useful Scripts & Companion Tools
sidebar_label: Useful Scripts & Companion Tools
---
import useBaseUrl from '@docusaurus/useBaseUrl';

This section offers external tools and scripts developed 
to extend functionality, enhance, or automate **TipTop** workflows.

## Running <i>N</i> **TipTop** simulations with different parameter values

Here, we provide an example script to run <i>N</i> **TipTop** simulations with different values of two parameters:
`ZenithAngle` and `Seeing`. The script can easily be adapted to modify only one parameter or more than two parameters.

The full example script is available for download 
<a href={`${useBaseUrl('/downloads/TIPTOP_RUN_N_SIM.py')}`} download="TIPTOP_RUN_N_SIM.py">**here**<span style={{ fontSize: '1.5em' }}>üì•</span></a>.

<details>
  <summary><strong> Running <i>N</i> **TipTop** simulations: `TIPTOP_RUN_N_SIM.py` </strong></summary>

  ```python
"""
Created on Thu Jul 10 10:00:34 2025
Run N TIPTOP simulations by sweeping over different parameter values.

@author: astro-tiptop-services
"""

#%% =============================================================================
# Import necessary libraries
from tiptop.tiptop import overallSimulation
import numpy as np
import configparser
from itertools import product
import os

#%% =============================================================================
# === File Paths ===
#üí° Adapt these paths to your environment
inputDir = "../MICADO/"   # Folder containing the .ini parameter file
inTag = "MICADO_SCAO"     # Name of the input parameter file (without extension)
outputDir = "./"          # Folder where the output FITS files will be saved 
tempDir = inputDir        # Temporary folder for modified .ini files
tempName = 'file_temp'    # Name of the temporary file

# Construct the full path to the input and temporary config files
inputFile = os.path.join(inputDir, f"{inTag}.ini")
tempFile = os.path.join(tempDir, f"{tempName}.ini")

# Base name for output files
outTagBase = "MICADO"

#%% =============================================================================
# === Define parameters to sweep ===
# üí° Format: (section_name, key_name, list_of_values : min, max, number of values)
param_sweep = [
    ("atmosphere", "Seeing", np.linspace(0.8, 2.0, 3)),
    ("telescope", "ZenithAngle", np.linspace(0.0, 60.0, 3)),
    # Add more parameters as needed
]

#%% =============================================================================
# === Read base configuration file ===
parser = configparser.ConfigParser()
parser.optionxform = str # Keep the original case of parameter keys
parser.read(inputFile)

#%% =============================================================================
# === Build and run combinations ===

# Extract parameter names and values
param_names = [f"{sec}.{key}" for sec, key, _ in param_sweep]
param_values = [vals for _, _, vals in param_sweep]

# Generate all combinations
for combo in product(*param_values):
    # Update .ini with current parameter values
    for (section, key, _), value in zip(param_sweep, combo):
        parser.set(section, key, str(value))
              
        # Write updated config to temporary .ini file
        with open(tempFile, "w") as configfile:
            parser.write(configfile)
        
        # Build output file tag
        tag_parts = [f"{name.split('.')[-1]}{val:.2f}" for name, val in zip(param_names, combo)]
        tag = f"{outTagBase}_{'_'.join(tag_parts)}"
        
        print(f"üîÑ Running simulation with: {dict(zip(param_names, combo))}")
        
        # Run TipTop simulation
        overallSimulation(
            path2param=tempDir,
            parametersFile=tempName,
            outputDir=outputDir,
            outputFile=tag,
            addSrAndFwhm=True
        )
  ```

</details>

## Rename output PSF FITS files and keep original copies

The full example script is available for download 
<a href={`${useBaseUrl('/downloads/TIPTOP_rename_psf_files.py')}`} download="TIPTOP_rename_psf_files.py">**here**<span style={{ fontSize: '1.5em' }}>üì•</span></a>.

<details>
  <summary><strong> Rename output PSF FITS files: `TIPTOP_rename_psf_files.py` </strong></summary>

  ```python
"""
Created on Thu Jul 10 14:15:45 2025
Rename output PSF FITS files sequentially for easier access and keep original copies.

@author: astro-tiptop-services
"""

#%% =============================================================================
# Import necessary libraries
import os
import shutil

#%% =============================================================================
# === Configuration ===
#üí° Adapt these paths to your environment
inputDir = "./"    # Directory containing the generated FITS files 
backupDir = "Original_PSFs"  # Directory to store backups of original files
outputDir = "Renamed_PSFs" # Directory where renamed files will be moved (must exist)

TagBase = "MICADO"     # Base name used in the output FITS filenames

# Create output and backup directories if they do not exist
os.makedirs(outputDir, exist_ok=True)
os.makedirs(backupDir, exist_ok=True)

#%% =============================================================================
# === Gather and sort relevant FITS files ===
output_files = sorted(
    [f for f in os.listdir(inputDir) if f.startswith(TagBase) and f.endswith(".fits")]
)

# Check if any matching files are found
if not output_files:
    print("[INFO] No matching FITS files found for renaming.")
else:
    print(f"[INFO] Found {len(output_files)} FITS files to rename.")

#%% =============================================================================
# === Copy and Rename files sequentially as TagBase_PSF1.fits, MICADO_PSF2.fits, etc. ===
for i, fname in enumerate(output_files):
    src = os.path.join(inputDir, fname)
    dst = os.path.join(outputDir, f"{TagBase}_PSF{i+1}.fits")
    backup = os.path.join(backupDir, fname)

    try:
        # Copy the original file to the backup folder
        shutil.copy2(src, backup)

        # Rename (and move) the file to the new destination
        os.rename(src, dst)
        print(f"[INFO] Renamed: {fname} ‚Üí {TagBase}_PSF{i+1}.fits (Backup saved)")
    except PermissionError:
        print(f"[‚ö†Ô∏è  WARNING] File in use and cannot be renamed: {fname}")
    except Exception as e:
        print(f"[‚ùå ERROR] Failed to rename {fname} ‚Üí {e}")

#%% =============================================================================
print(f"\n‚úÖ Process complete. {len(output_files)} files renamed and backed up.")




  ```
</details>